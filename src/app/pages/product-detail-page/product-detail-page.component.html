<div class="page-container">

  <header class="page-header">
    <button class="btn ghost" type="button" (click)="back()">← Volver</button>

    @if (product) {
      <div class="header-info">
        <h2>{{ product.name }}</h2>

        <div class="badges">
          @if (product.featured) {
            <span class="badge badge-star">⭐ Destacado</span>
          }
          @if (product.discount && product.discount > 0) {
            <span class="badge badge-discount">{{ product.discount }}% OFF</span>
          }
          @if (product.hasHappyHour) {
            <span class="badge badge-ok">✅ Happy Hour</span>
          }
        </div>

        <p class="meta">
          @if (product.categoryName) {
            Categoría: <strong>{{ product.categoryName }}</strong>
          } @else {
            <span class="muted">Sin categoría</span>
          }
        </p>
      </div>
    }
  </header>

  @if (isLoading) {
    <section class="card loading-state">
      <p>Cargando producto...</p>
    </section>
  }

  @if (!isLoading && errorMsg) {
    <section class="card empty-state">
      <h3>¡Ups!</h3>
      <p>{{ errorMsg }}</p>
    </section>
  }

  @if (!isLoading && !errorMsg && product) {
    <main class="card product-card">

      <div class="top">
        <div class="left">
          <h3 class="title">{{ product.name }}</h3>

          @if (product.description) {
            <p class="desc">{{ product.description }}</p>
          } @else {
            <p class="desc muted">Sin descripción.</p>
          }

          @if (product.labels?.length > 0) {
            <div class="labels">
              @for (l of product.labels; track l) {
                <span class="label">{{ l }}</span>
              }
            </div>
          }
        </div>

        <div class="price">
          @if (product.discount && product.discount > 0) {
            <span class="old">${{ product.price }}</span>
            <span class="now">${{ finalPrice() }}</span>
          } @else {
            <span class="now">${{ product.price }}</span>
          }
        </div>
      </div>

      <section class="section">
        <h4>Detalles</h4>

        <div class="details">
          <div class="row">
            <span class="k">Categoría</span>
            <span class="v">
              @if (product.categoryName) { {{ product.categoryName }} } @else { — }
            </span>
          </div>

          <div class="row">
            <span class="k">Precio base</span>
            <span class="v">${{ product.price }}</span>
          </div>

          <div class="row">
            <span class="k">Descuento</span>
            <span class="v">
              @if (product.discount && product.discount > 0) { {{ product.discount }}% } @else { — }
            </span>
          </div>

          <div class="row">
            <span class="k">Precio final</span>
            <span class="v">${{ finalPrice() }}</span>
          </div>

          <div class="row">
            <span class="k">Happy Hour</span>
            <span class="v">
              @if (product.hasHappyHour) { Activo } @else { — }
            </span>
          </div>

          <div class="row">
            <span class="k">Destacado</span>
            <span class="v">
              @if (product.featured) { Sí } @else { — }
            </span>
          </div>

          <div class="row">
            <span class="k">Recomendado para</span>
            <span class="v">
              @if (product.recommendedFor && product.recommendedFor > 0) { {{ product.recommendedFor }} } @else { — }
            </span>
          </div>

          <div class="row row-full">
            <span class="k">Etiquetas</span>
            <span class="v">
              @if (product.labels?.length > 0) { {{ product.labels.join(', ') }} } @else { — }
            </span>
          </div>
        </div>
      </section>

      <!-- ✅ Nota: NO mostramos id, userId, categoryId -->
    </main>
  }

</div>
